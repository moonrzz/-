# 寝室物联网智能开关详细设计说明书

## 1. 引言

### 1.1 设计目的
设计一个基于物联网的舵机单元，实现在寝室WIFI环境下，管理员可以使用微信小程序联网远程控制舵机对寝室顶灯开关进行控制。

### 1.2 背景
由于主创开发者总是在课余时间编写代码或设计项目结构，经常在其余舍友上床后开始洗漱，然而其记性较差，每次都忘记关灯。鉴于舍友有网页前端设计、硬件电路设计经验，遂策划发起本项目。

### 1.3 参考资料
- [阿里云物联网平台最完全的使用教程-CSDN@一条草鱼](http://t.csdnimg.cn/A1NuI)
- [物联网微信小程序接入阿里云物联网平台-CSDN@指针阿飞](http://t.csdnimg.cn/tyo0F)
- [使用微信小程序连接到 MQTT 云服务-ZHIHU@EMQ](https://zhuanlan.zhihu.com/p/406581345)
- [Arduino ESP8266控制SG90舵机输出PWM信号-CSDN@西米33](http://t.csdnimg.cn/ka6XH)

### 1.4 项目成员
- **郑皓文** - 硬件结构设计、硬件电路焊接、舵机端软件设计、云服务器端调试（光赛经验）
- **张建权** - 小程序WEB前端页面设计、云服务器接口对接（星辰工作室骨干、WEB前端开发经验）
- **刘畅** - 开发板引脚分配、硬件电路拓扑、PCB板设计绘制（启梦杯硬件设计经验）

## 2. 项目系统的软件结构

![智能开关系统的软件执行逻辑](图1链接)

## 3. 项目详细设计说明暨设计流程

### 3.1 云服务器端配置
本项目云服务器端使用阿里云公司提供的免费物联网云平台。根据参考资料成功完成云服务器上的手机端、舵机端设备实例的创建，并利用阿里云物联网平台的在线调试功能，实现了两设备之间的云产品流转与消息转发。

![物联网云服务器的配置](图2链接)

### 3.2 开发板验证与下位机程序设计
本项目利用Arduino IDE开发ESP8266开发板，利用开发板的WIFI模组与阿里云官方提供的MQTT云服务库实现了下位机与云服务器的通讯。

![下位机开发板调试记录](图3链接)

### 3.3 硬件电路拓扑与PCB设计与打板
项目成员首先根据ESP8266开发板的IO口引出图以及软件程序的设计对开发板进行引脚分配，便于PCB布线。

![主板硬件电路拓扑](图5链接)

### 3.4 微信小程序前端页面设计及服务器接口对接
本项目根据MQTT云服务官方提供的订阅模板实现与阿里云服务器的接口对接，使用 HTML/CSS/Javascript 语言对小程序页面进行视觉设计，并设计按键回调函数。

![小程序端页面设计与接口对接](图6链接)

### 3.5 硬件结构设计
在本项目中，使用650mAH锂电池连接CD42电源模块+TYPE-C母座实现产品的升压与充放电、电量显示功能。

![电源结构设计](图8链接)

## 4. 产品成品展示

![产品成品展示图](图11链接)

---
